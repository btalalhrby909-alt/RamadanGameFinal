<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸŒ™ ØªØ­Ø¯ÙŠ Ø±Ù…Ø¶Ø§Ù† Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { 
            background: #020617 url('https://www.transparenttextures.com/patterns/islamic-art.png'); 
            color: white; font-family: 'Segoe UI', sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0;
        }
        .box { background: rgba(30, 41, 59, 0.95); padding: 25px; border-radius: 15px; border: 2px solid #fbbf24; text-align: center; width: 350px; }
        #messages { height: 150px; overflow-y: auto; background: rgba(0,0,0,0.2); margin: 10px 0; padding: 10px; border-radius: 8px; text-align: right; border: 1px solid #334155; }
        .score-item { color: #fbbf24; font-size: 0.9em; margin-bottom: 5px; }
        input { width: 90%; padding: 10px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #0f172a; color: white; text-align: center; }
        .btn { background: #fbbf24; color: black; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; }
    </style>
</head>
<body>
    <div class="box" id="lobby">
        <h1>Ù…Ø¬Ù„Ø³ Ø±Ù…Ø¶Ø§Ù† ğŸŒ™</h1>
        <input type="text" id="username" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±">
        <input type="text" id="roomCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
        <button class="btn" onclick="connectToRoom()">Ø¯Ø®ÙˆÙ„ Ø§Ù„ØºØ±ÙØ© ğŸš€</button>
    </div>

    <div class="box" id="game" style="display: none;">
        <div id="scoreBoard" style="margin-bottom: 10px; border-bottom: 1px solid #fbbf24; padding-bottom: 5px;"></div>
        <div style="display: flex; justify-content: space-around; margin-bottom: 10px;">
            <div>Ø§Ù„ÙØ¦Ø©: <span id="catDisplay" style="color: #fbbf24;">-</span></div>
            <div>Ø§Ù„Ø­Ø±Ù: <span id="charDisplay" style="color: #fbbf24;">-</span></div>
        </div>
        <div id="messages"></div>
        <input type="text" id="answerInput" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ...">
        <button class="btn" onclick="sendAnswer()">Ø¥Ø±Ø³Ø§Ù„ âœ…</button>
    </div>

    <script>
        const socket = io(); // Ø³ÙŠØ±Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø±Ø§Ø¨Ø· Render

        function connectToRoom() {
            const name = document.getElementById('username').value;
            const room = document.getElementById('roomCode').value;
            if (name && room) {
                document.getElementById('lobby').style.display = 'none';
                document.getElementById('game').style.display = 'block';
                socket.emit('joinRoom', room, name);
            }
        }

        function sendAnswer() {
            const input = document.getElementById('answerInput');
            if (input.value) {
                socket.emit('submitAnswer', input.value);
                input.value = '';
            }
        }

        socket.on('chatMessage', (data) => {
            const div = document.getElementById('messages');
            div.innerHTML += `<div><span style="color:#fbbf24">${data.name}:</span> ${data.text}</div>`;
            div.scrollTop = div.scrollHeight;
        });

        socket.on('updateScores', (scores) => {
            const board = document.getElementById('scoreBoard');
            board.innerHTML = "";
            for (let user in scores) {
                board.innerHTML += `<div class="score-item">${user}: ${scores[user]} Ù†Ù‚Ø·Ø©</div>`;
            }
        });

        socket.on('gameUpdate', (data) => {
            document.getElementById('catDisplay').innerText = data.category;
            document.getElementById('charDisplay').innerText = data.char;
        });
    </script>
</body>
</html>
