<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸŒ™ Ù„Ø¹Ø¨Ø© Ø¢Ø®Ø± Ø­Ø±Ù</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { 
            background: #020617 url('https://www.transparenttextures.com/patterns/islamic-art.png'); 
            color: white; font-family: 'Cairo', sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0;
        }
        .container { 
            width: 90%; max-width: 800px; background: rgba(15, 23, 42, 0.9); 
            padding: 40px; border-radius: 25px; border: 3px solid #fbbf24; box-shadow: 0 0 50px rgba(251, 191, 36, 0.2);
        }
        .player-list { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; margin-bottom: 20px; }
        .active-turn { border: 2px solid #fbbf24; animation: glow 1s infinite alternate; }
        @keyframes glow { from { box-shadow: 0 0 5px #fbbf24; } to { box-shadow: 0 0 20px #fbbf24; } }
        #status-box { font-size: 1.5em; margin: 20px 0; color: #fbbf24; }
        input { width: 70%; padding: 15px; border-radius: 10px; border: none; font-size: 1.2em; }
        .btn { background: #fbbf24; color: black; padding: 15px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; border: none; }
        .details-btn { margin-top: 20px; background: none; color: #fbbf24; border: 1px solid #fbbf24; }
    </style>
</head>
<body>

<div class="container" id="lobby">
    <h1>ğŸŒ™ Ù„Ø¹Ø¨Ø© Ø¢Ø®Ø± Ø­Ø±Ù</h1>
    <input type="text" id="username" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±"><br><br>
    <input type="text" id="roomCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©"><br><br>
    <button class="btn" onclick="connect()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© ğŸš€</button>
    <br>
    <button class="btn details-btn" onclick="alert('Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©:\n1. ØªØ¨Ø¯Ø£ Ø¨ÙØ¦Ø© ÙˆØ­Ø±Ù.\n2. Ù‚Ù„ ÙƒÙ„Ù…Ø© ØªØ¨Ø¯Ø£ Ø¨Ø¢Ø®Ø± Ø­Ø±Ù Ù…Ù…Ø§ Ù‚Ø§Ù„Ù‡ Ø²Ù…ÙŠÙ„Ùƒ.\n3. Ø§Ù„ÙØ¦Ø§Øª ØªØªØºÙŠØ± (Ø§Ø³Ù…ØŒ Ø­ÙŠÙˆØ§Ù†...).\n4. Ø£ÙˆÙ„ Ù…Ù† ÙŠØµÙ„ Ù„Ù€ 5 Ù†Ù‚Ø§Ø· ÙŠÙÙˆØ²!')">ğŸ“œ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
</div>

<div class="container" id="game" style="display:none;">
    <div class="player-list" id="players"></div>
    <div id="status-box">
        Ø§Ù„ÙØ¦Ø©: <span id="catDisplay">-</span> | Ø§Ù„Ø­Ø±Ù: <span id="charDisplay">-</span>
    </div>
    <h2 id="turnNotify" style="color: #4ade80; display:none;">ğŸ”” Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†!</h2>
    <div id="chat" style="height: 150px; overflow-y: auto; margin-bottom: 20px; text-align: right; background: rgba(0,0,0,0.2); padding: 10px;"></div>
    <input type="text" id="wordInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø© Ù‡Ù†Ø§...">
    <button class="btn" onclick="send()">Ø¥Ø±Ø³Ø§Ù„ âœ…</button>
    <br><br>
    <button id="startBtn" class="btn" onclick="socket.emit('startGame')" style="display:none;">Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø© ğŸš©</button>
</div>

<script>
    const socket = io();
    let myName = "";

    function connect() {
        myName = document.getElementById('username').value;
        const room = document.getElementById('roomCode').value;
        if (myName && room) {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            socket.emit('joinRoom', room, myName);
        }
    }

    function send() {
        const input = document.getElementById('wordInput');
        socket.emit('submitAnswer', input.value);
        input.value = "";
    }

    socket.on('updateData', (data) => {
        const pDiv = document.getElementById('players');
        pDiv.innerHTML = "<b>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†: </b>" + data.players.map(p => 
            `<span style="${p === data.activePlayers[data.turnIndex] ? 'color:#fbbf24; font-weight:bold;' : ''}">${p} (${data.scores[p]}Ù†)</span>`
        ).join(" | ");

        document.getElementById('catDisplay').innerText = data.category || "-";
        document.getElementById('charDisplay').innerText = data.currentChar || "-";
        
        // ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø¯ÙˆØ±
        const isMyTurn = data.activePlayers[data.turnIndex] === myName;
        document.getElementById('turnNotify').style.display = isMyTurn ? "block" : "none";
        
        if (!data.gameStarted && data.players[0] === myName) {
            document.getElementById('startBtn').style.display = "inline-block";
        } else {
            document.getElementById('startBtn').style.display = "none";
        }
    });

    socket.on('chatMessage', (data) => {
        const chat = document.getElementById('chat');
        chat.innerHTML += `<div><b>${data.name}:</b> ${data.text}</div>`;
        chat.scrollTop = chat.scrollHeight;
    });
</script>
</body>
</html>
