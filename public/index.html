<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ­Ø¯ÙŠ Ø±Ù…Ø¶Ø§Ù† Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ğŸŒğŸŒ™</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        :root { --gold: #fbbf24; --night: #020617; --emerald: #064e3b; --danger: #ef4444; }
        body { background: var(--night); color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .box { width: 90%; max-width: 500px; padding: 30px; border: 2px solid var(--gold); border-radius: 40px; background: rgba(30, 41, 59, 0.95); text-align: center; box-shadow: 0 0 30px rgba(251, 191, 36, 0.1); }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 15px; border: 1px solid #334155; background: #0f172a; color: white; text-align: center; font-size: 18px; }
        .btn { cursor: pointer; padding: 15px; border-radius: 15px; border: none; font-weight: bold; width: 100%; margin-top: 10px; transition: 0.3s; font-size: 18px; }
        .btn-gold { background: var(--gold); color: black; }
        .btn-gold:hover { transform: scale(1.02); }
        #timer { font-size: 60px; font-weight: 900; color: var(--gold); margin: 10px 0; }
        .status-msg { margin-top: 15px; font-weight: bold; color: var(--gold); min-height: 24px; }
    </style>
</head>
<body>

<div class="box" id="mainBox">
    <div id="lobby">
    <h1>Ù…Ø¬Ù„Ø³ Ø±Ù…Ø¶Ø§Ù† ğŸŒ™</h1>
    <input type="text" id="username" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±">
    <input type="text" id="roomCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ© (Ù…Ø«Ù„Ø§Ù‹: 123)">
    <button class="btn btn-gold" onclick="connectToRoom()">Ø¯Ø®ÙˆÙ„ Ø§Ù„ØºØ±ÙØ© ğŸš€</button>
</div>

    <div id="game" style="display: none;">
        <div style="display: flex; justify-content: space-around; font-size: 20px; font-weight: bold;">
            <div>Ø§Ù„ÙØ¦Ø©: <span id="catDisplay" style="color: white;">-</span></div>
            <div>Ø§Ù„Ø­Ø±Ù: <span id="charDisplay" style="color: white;">-</span></div>
        </div>
        
        <div id="timer">20</div>

        <input type="text" id="answerInput" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§..." autocomplete="off">
        <button class="btn btn-gold" onclick="sendAnswer()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© âœ…</button>
        
        <div class="status-msg" id="status"></div>
    </div>
</div>

<script>
    const socket = io("https://ramadangamefinal.onrender.com");

    function connectToRoom() {
        const name = document.getElementById('username').value;
        const room = document.getElementById('roomCode').value;
        if (name && room) {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            socket.emit('joinRoom', room, name);
        } else {
            alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙˆÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©!");
        }
    }

    function sendAnswer() {
        const ans = document.getElementById('answerInput').value;
        if (ans) {
            socket.emit('submitAnswer', ans);
            document.getElementById('answerInput').value = ''; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø®Ø§Ù†Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
        }
    }

    // Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ¹Ø±Ø¶Ù‡Ø§ ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
    socket.on('chatMessage', (data) => {
        const statusMsg = document.getElementById('status');
        const newMsg = document.createElement('div');
        newMsg.innerHTML = `<strong>${data.name}:</strong> ${data.text}`;
        statusMsg.appendChild(newMsg);
        
        // Ù…Ø³Ø­ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†Ù Ù„ÙŠØ¨Ù‚Ù‰ Ø§Ù„Ù…ÙƒØ§Ù† Ù†Ø¸ÙŠÙØ§Ù‹
        setTimeout(() => { newMsg.remove(); }, 5000);
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø±Ù ÙˆØ§Ù„ÙØ¦Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹ ÙÙŠ Ø§Ù„ØºØ±ÙØ©
    socket.on('gameUpdate', (data) => {
        document.getElementById('catDisplay').innerText = data.category;
        document.getElementById('charDisplay').innerText = data.char;
    });
</script>