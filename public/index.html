<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸŒ™ ØªØ­Ø¯ÙŠ Ø±Ù…Ø¶Ø§Ù† Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        :root { --gold: #fbbf24; --night: #020617; }
        body { 
            background: var(--night) url('https://www.transparenttextures.com/patterns/islamic-art.png'); 
            color: white; font-family: 'Segoe UI', sans-serif;
            display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0;
        }
        .box { 
            width: 90%; max-width: 500px; background: rgba(30, 41, 59, 0.9); 
            padding: 20px; border-radius: 15px; border: 2px solid var(--gold); text-align: center;
        }
        #messages { 
            height: 200px; overflow-y: auto; background: rgba(0,0,0,0.3); 
            margin: 15px 0; padding: 10px; border-radius: 10px; text-align: right;
        }
        .score-board { color: var(--gold); font-weight: bold; margin-bottom: 10px; }
        input { width: 80%; padding: 10px; margin: 5px 0; border-radius: 5px; border: none; }
        .btn-gold { background: var(--gold); color: black; border: none; padding: 10px 20px; cursor: pointer; border-radius: 5px; font-weight: bold; }
    </style>
</head>
<body>

<div class="box" id="lobby">
    <h1>Ù…Ø¬Ù„Ø³ Ø±Ù…Ø¶Ø§Ù† ğŸŒ™</h1>
    <input type="text" id="username" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±">
    <input type="text" id="roomCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
    <button class="btn-gold" onclick="connectToRoom()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© ğŸš€</button>
</div>

<div class="box" id="game" style="display: none;">
    <div class="score-board" id="scoreList">Ø§Ù„Ù†Ù‚Ø§Ø·: Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    <div style="display: flex; justify-content: space-around; font-size: 1.2em;">
        <div>Ø§Ù„ÙØ¦Ø©: <span id="catDisplay" style="color: var(--gold);">-</span></div>
        <div>Ø§Ù„Ø­Ø±Ù: <span id="charDisplay" style="color: var(--gold);">-</span></div>
    </div>
    
    <div id="messages"></div> <input type="text" id="answerInput" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§...">
   <script>
    const socket = io("https://ramadangamefinal.onrender.com");

    function connectToRoom() {
        const name = document.getElementById('username').value;
        const room = document.getElementById('roomCode').value;
        if (name && room) {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            socket.emit('joinRoom', room, name);
        } else {
            alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙˆÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©!");
        }
    }

    function sendAnswer() {
        const input = document.getElementById('answerInput');
        if (input.value) {
            socket.emit('submitAnswer', input.value);
            input.value = ''; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø®Ø§Ù†Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
        }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù… (Ù„Ù† ØªØ®ØªÙÙŠ)
    socket.on('chatMessage', (data) => {
        const statusDiv = document.getElementById('status');
        const newMsg = document.createElement('div');
        newMsg.style.padding = "5px";
        newMsg.style.borderBottom = "1px solid rgba(251, 191, 36, 0.2)";
        // Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        newMsg.innerHTML = `<span style="color: #fbbf24;">${data.name}:</span> ${data.text}`;
        statusDiv.appendChild(newMsg);
        statusDiv.scrollTop = statusDiv.scrollHeight; // Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„ÙØ¦Ø© ÙˆØ§Ù„Ø­Ø±Ù Ù„Ù„Ø¬Ù…ÙŠØ¹
    socket.on('gameUpdate', (data) => {
        if(data.category) document.getElementById('catDisplay').innerText = data.category;
        if(data.char) document.getElementById('charDisplay').innerText = data.char;
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù†Ø¸Ø§Ù… Ù†Ù‚Ø§Ø· Ù…Ø±Ø³Ù„ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
        if(data.allScores) {
            let scoreText = "Ø§Ù„Ù†Ù‚Ø§Ø·: ";
            for (let user in data.allScores) {
                scoreText += `${user} [${data.allScores[user]}] | `;
            }
            // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± div ÙÙŠ HTML Ù„Ø¹Ø±Ø¶ scoreText
        }
    });
</script>
